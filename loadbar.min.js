!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):t.Loadbar=i()}(this,function(){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")},e=function(){function t(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(i,e,n){return e&&t(i.prototype,e),n&&t(i,n),i}}(),n=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},s=window.cancelAnimationFrame||window.webkitCancelAnimationFrame,r=function(t){return t instanceof HTMLElement},a=function(t,i){for(var e in i)e in t.style&&(t.style[e]=i[e])},h=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},l=function(t,i,e,n){return e*t/n+i};return function(){function u(e,o){i(this,u),o="object"===(void 0===o?"undefined":t(o))?o:{};var s={height:"2px",backgroundColor:"blue"};this.el="string"==typeof e?document.querySelector(e):e,this.options=n({},s,o),this.isAnimating=!1,this.duration=1.5,this.requestId=null;var r=void 0;Object.defineProperties(this,{maxWidth:{value:100},barWidth:{get:function(){return r},set:function(t){t<0&&(t=0),t>100&&(t=100),r=t}}}),this.barWidth=0;var a=void 0;Object.defineProperty(this.options,"height",{get:function(){return a},set:function(t){var i=parseInt(t);i>5&&(t="5px"),i<=0&&(t="1px"),a=t}}),this.options.height=o.height||s.height,this._init()}return e(u,[{key:"_init",value:function(){!r(this.el)&&this._createElement(),this._createChildElement()}},{key:"_createElement",value:function(){this.el=document.createElement("div"),document.getElementsByTagName("body")[0].appendChild(this.el),this.el.style.position="fixed",this.el.style.top=0,this.el.style.left=0,this.el.style.right=0,this.el.style.height=this.options.height,this.el.style.backgroundColor="transparent"}},{key:"_createChildElement",value:function(){console.log("create child element"),h(this.el),this.childEl=document.createElement("div"),this.el.appendChild(this.childEl),a(this.childEl,this.options),this._renderBar(),this.childEl.style.height="100%",this.childEl.style.opacity="1"}},{key:"_renderBar",value:function(){this.childEl.style.width=this.barWidth+"%"}},{key:"_update",value:function(t,i){this.barWidth=l(t,this.barWidth,i-this.barWidth,this.duration)}},{key:"_grow",value:function(t){var i=(Date.now()-this.lastTime)/1e3;this._update(i,t),this._renderBar();var e=t-this.barWidth;e<=.1&&e>-.1&&this.pause(),this.isAnimating&&(this.requestId=o(this._grow.bind(this,t)))}},{key:"_begin",value:function(){this.childEl.style.opacity=1,this.isAnimating||(s(this.requestId),this.isAnimating=!0,this.duration=1.5,this.lastTime=Date.now())}},{key:"_finish",value:function(){var t=this;this.childEl.style.opacity=1,this.isAnimating=!0,this.duration=.3,this.lastTime=Date.now(),setTimeout(function(){t._fadeOut(t.childEl),t.barWidth=0},300)}},{key:"_fadeOut",value:function(t){t.style.opacity||(t.style.opacity=1),t.style.opacity-=.1,t.style.opacity>0&&o(this._fadeOut.bind(this,t))}},{key:"growTo",value:function(t){this._begin(),this._grow(t)}},{key:"start",value:function(){this._begin(),this.barWidth=0,this._grow(10)}},{key:"loading",value:function(){this._begin(),this._grow(this.barWidth+.5+Math.random())}},{key:"pause",value:function(){s(this.requestId),this.isAnimating=!1}},{key:"done",value:function(){this._finish(),this._grow(100)}}]),u}()});
