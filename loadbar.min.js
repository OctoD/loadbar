!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Loadbar=e()}(this,function(){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},s=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},o=window.cancelAnimationFrame||window.webkitCancelAnimationFrame,r=function(t){return t instanceof HTMLElement},h=function(t,e){for(var i in e)i in t.style&&(t.style[i]=e[i])},a=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},l=function(t,e,i,n){return i*t/n+e},u=document.getElementsByTagName("body")[0];return function(){function d(i,s){e(this,d),i="object"===(void 0===i?"undefined":t(i))?i:{};var o={height:"2px",backgroundColor:"blue",easeFunction:l,zIndex:999};this.el="string"==typeof s?document.querySelector(s):s,this.parentEl=this.el?this.el.parentElement:u,this.options=n({},o,i),this.isAnimating=!1,this.duration=1.5,this.rAFId=null,this.elementDestroyed=!1;var r=void 0;Object.defineProperties(this,{maxWidth:{value:100},barWidth:{get:function(){return r},set:function(t){t<0&&(t=0),t>100&&(t=100),r=t}}}),this.barWidth=0;var h=void 0;Object.defineProperty(this.options,"height",{get:function(){return h},set:function(t){var e=parseInt(t);e>5&&(t="5px"),e<=0&&(t="1px"),h=t}}),this.options.height=i.height||o.height,this._init()}return i(d,[{key:"_init",value:function(){this.elementDestroyed&&this.parentEl.appendChild(this.el),r(this.el)?this._cssElement():this._createElement(),this._createChildElement()}},{key:"_cssElement",value:function(){this.el.style.height=this.options.height,this.el.style.backgroundColor="transparent"}},{key:"_createElement",value:function(){this.el=document.createElement("div"),u.appendChild(this.el),this._cssElement(),this.el.style.position="fixed",this.el.style.top=0,this.el.style.left=0,this.el.style.right=0}},{key:"_createChildElement",value:function(){a(this.el),this.childEl=document.createElement("div"),this.el.appendChild(this.childEl),h(this.childEl,this.options),this._renderBar(),this.childEl.style.height="100%",this.childEl.style.opacity="1"}},{key:"_renderBar",value:function(){this.childEl.style.width=this.barWidth+"%"}},{key:"_update",value:function(t,e){this.barWidth=this.options.easeFunction(t,this.barWidth,e-this.barWidth,this.duration)}},{key:"_grow",value:function(t){var e=(Date.now()-this.lastTime)/1e3;this._update(e,t),this._renderBar();var i=t-this.barWidth;return i<=.1&&i>-.1?this.loading():this.barWidth===this.maxWidth&&this.isAnimating?this.stop():this.isAnimating?this.rAFId=s(this._grow.bind(this,t)):void 0}},{key:"_begin",value:function(){return this.elementDestroyed&&this._init(),o(this.rAFId),this.isAnimating?this:(this.isAnimating=!0,this.duration=1.5,this.lastTime=Date.now(),this)}},{key:"_finish",value:function(){return o(this.rAFId),this.isAnimating=!0,this.duration=.3,this.lastTime=Date.now(),this}},{key:"_fadeOut",value:function(t){return t.style.opacity||(t.style.opacity=1),t.style.opacity-=.1,t.style.opacity>0&&s(this._fadeOut.bind(this,t)),Promise.resolve()}},{key:"growTo",value:function(t){this._begin()._grow(t)}},{key:"start",value:function(){this.barWidth=0,this.growTo(10)}},{key:"loading",value:function(){this.pause().growTo(this.barWidth+.3+.5*Math.random())}},{key:"pause",value:function(){return o(this.rAFId),this.isAnimating=!1,this}},{key:"stop",value:function(){var t=this;o(this.rAFId),this.isAnimating=!1,this._fadeOut(this.childEl).then(function(){return setTimeout(function(){return t.destroy()},300)})}},{key:"destroy",value:function(){this.barWidth=0,this.parentEl.removeChild(this.el),this.elementDestroyed=!0}},{key:"done",value:function(){this._finish()._grow(100)}}]),d}()});
